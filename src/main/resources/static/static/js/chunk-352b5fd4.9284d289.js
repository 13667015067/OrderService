(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-352b5fd4"],{"243c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"listQuery",attrs:{model:e.listQuery,inline:!0}},[a("el-form-item",{attrs:{label:"模板名称"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入模版名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.listQuery.modelName,callback:function(t){e.$set(e.listQuery,"modelName",t)},expression:"listQuery.modelName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.handleCreate}},[e._v("新增 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.tplList},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{label:"模块号",prop:"id",width:"80"}}),a("el-table-column",{attrs:{label:"applyId",prop:"applyId"}}),a("el-table-column",{attrs:{label:"名称",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"创建者",prop:"createUser","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑模板 ")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除 ")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageIndex,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageIndex",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),a("el-dialog",{staticStyle:{"margin-top":"0"},attrs:{title:1===e.dialogFormVisibleName?"新建模版":"编辑模版",visible:e.open,fullscreen:!0},on:{"update:visible":function(t){e.open=t}}},[a("div",{staticClass:"tpl-create-content"},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"模板名称",prop:"modelName"}},[a("el-input",{model:{value:e.ruleForm.modelName,callback:function(t){e.$set(e.ruleForm,"modelName",t)},expression:"ruleForm.modelName"}})],1),a("el-form-item",{attrs:{label:"模板"}},[a("f-render",{ref:"frender",attrs:{loading:e.loading,height:"calc(100vh - 60px)",config:e.formConfig,"options-fn":e.$axios.get},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}})],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){1===e.dialogFormVisibleName?e.submitForm("ruleForm"):e.editForm("ruleForm")}}},[e._v(" 提交 ")]),a("el-button",{on:{click:function(t){e.open=!1}}},[e._v("取 消")])],1)],1)])],1)],1)},o=[],n=(a("fe59"),a("053b"),a("e35a"),a("0d7a"),a("08ba"),a("6a61"),a("327b")),l=a("e33d"),i=a("5f87"),s=a("b562"),d={name:"Template",watch:{"$store.state.myApp.currentApp":{handler:function(e,t){e&&this.getList()},deep:!0,immediate:!0}},data:function(){return{formConfig:"",formData:{},appList:[],dialogFormVisibleName:1,queryParams:{pageIndex:1,pageSize:10},loading:!1,ids:[],single:!0,multiple:!0,total:0,open:!1,tplList:[],listQuery:{modelName:""},ruleForm:{modelName:"",id:""},rules:{modelName:[{required:!0,message:"请输入模板名称",trigger:"blur"}]}}},created:function(){},mounted:function(){},methods:{querySearchAsync:function(e,t){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a.appList.length){e.next=4;break}return r={account:Object(i["a"])(),applyName:""},e.next=4,s["a"].getApplyInfos(r).then((function(e){200==e.code&&(e.data.forEach((function(e){e.value=e.applyName})),a.appList=e.data)}));case 4:t(a.appList);case 5:case"end":return e.stop()}}),e)})))()},handleQuery:function(e){this.listQuery.modelName?this.getModelByName():(this.queryParams.pageIndex=1,this.queryParams.pageSize=10,this.getList())},getModelByName:function(){var e=this,t={};t.modelName=this.listQuery.modelName,t.applyId=this.$store.getters.currentApp.id,l["a"].getModelByName(t).then((function(t){200==t.code&&(t.data.forEach((function(e){e.createTime=new Date(e.createTime).toLocaleDateString().split(" ")[0]})),e.tplList=t.data,e.total=0)}))},getList:function(){var e=this;this.loading=!0;var t={},a=this.$store.getters.currentApp.id;t.applyId=a,t.page=this.queryParams.pageIndex,t.amount=this.queryParams.pageSize,l["a"].getModelByPage(t).then((function(t){200==t.code?(t.data.models.forEach((function(e){e.createTime=new Date(e.createTime).toLocaleDateString().split(" ")[0]})),e.tplList=t.data.models,e.total=t.data.pageSize*e.queryParams.pageSize):(e.tplList=[],e.$message({message:t.msg,type:"error"})),e.loading=!1}))},handleCreate:function(){this.ruleForm={modelName:""},this.dialogFormVisibleName=1,this.open=!0},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a=t.$refs.frender.getFormConfig();if(a.order.length){var r=new FormData;r.append("applyId",t.$store.getters.currentApp.id),r.append("modelName",t.ruleForm.modelName),r.append("account",Object(i["a"])()),r.append("data",JSON.stringify(a)),l["a"].addModel(r).then((function(e){200==e.code?(t.$message({type:"success",message:e.msg}),t.getList()):t.$message({type:"error",message:e.msg})}))}else t.$message({type:"error",message:"请选择模板组件!"})}}))},handleEdit:function(e){this.ruleForm={modelName:e.name,id:e.id},this.formConfig=e.data,this.dialogFormVisibleName=2,this.open=!0},editForm:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a=t.$refs.frender.getFormConfig();if(a.order.length){var r=new FormData;r.append("id",t.ruleForm.id),r.append("name",t.ruleForm.modelName),r.append("data",JSON.stringify(a)),l["a"].updateModel(r).then((function(e){200==e.code?(t.$message({type:"success",message:e.msg}),t.getList()):t.$message({type:"error",message:e.msg})}))}else t.$message({type:"error",message:"请选择模板组件!"})}}))},handleDelete:function(e){var t=this,a={};a.id=e.id,l["a"].deleteModelById(a).then((function(e){200==e.code?(t.$message({type:"success",message:e.msg}),t.getList()):t.$message({type:"error",message:e.msg})}))},handleSelectionChange:function(){}}},m=d,u=a("9ca4"),c=Object(u["a"])(m,r,o,!1,null,null,null);t["default"]=c.exports},e33d:function(e,t,a){"use strict";var r=a("b775");t["a"]={addModel:function(e){return Object(r["a"])({url:"/model/addModel",method:"post",data:e})},updateModel:function(e){return Object(r["a"])({url:"/model/updateModel",method:"post",data:e})},deleteModelById:function(e){return Object(r["a"])({url:"/model/deleteModelById",method:"post",data:e})},getModelByPage:function(e){return r["a"].get("/model/getModelByPage",{params:e})},getAllModelName:function(e){return r["a"].get("/model/getAllModelName",{params:e})},getModelByName:function(e){return r["a"].get("/model/getModelByName",{params:e})},getOrderInfo:function(e){return r["a"].get("/orderInfo/getOrderInfo",{params:e})},getWork:function(e){return r["a"].get("/work/getWork",{params:e})},delOrderInfo:function(e){return Object(r["a"])({url:"/orderInfo/delOrderInfo",method:"post",data:e})}}}}]);