(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-561b8d5f"],{"243c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"listQuery",attrs:{model:e.listQuery,inline:!0}},[a("el-form-item",{attrs:{label:"应用名称"}},[a("el-autocomplete",{staticStyle:{width:"240px"},attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入应用名称搜索模板"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.listQuery.applyName,callback:function(t){e.$set(e.listQuery,"applyName",t)},expression:"listQuery.applyName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.handleCreate}},[e._v("新增")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.tplList},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{label:"applyId",prop:"applyId"}}),a("el-table-column",{attrs:{label:"创建者",prop:"createUser","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑模板")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageIndex,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageIndex",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),a("el-dialog",{staticStyle:{"margin-top":"0"},attrs:{title:1===e.dialogFormVisibleName?"新建模版":"编辑模版",visible:e.open,fullscreen:!0},on:{"update:visible":function(t){e.open=t}}},[a("div",{staticClass:"tpl-create-content"},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"applyId",prop:"applyId"}},[a("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.applyId,callback:function(t){e.$set(e.ruleForm,"applyId",t)},expression:"ruleForm.applyId"}})],1),a("el-form-item",{attrs:{label:"模板"}},[a("f-render",{ref:"frender",attrs:{loading:e.loading,height:"calc(100vh - 60px)",config:e.formConfig,"options-fn":e.$axios.get},on:{save:e.handleSave},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}})],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){1===e.dialogFormVisibleName?e.submitForm("ruleForm"):e.editForm("ruleForm")}}},[e._v("提交")]),a("el-button",{on:{click:function(t){e.open=!1}}},[e._v("取 消")])],1)],1)])],1)],1)},r=[],i=(a("4194"),a("fe59"),a("e35a"),a("0d7a"),a("08ba"),a("22dc")),l=(a("6a61"),a("327b")),o=a("b775");function s(e){return Object(o["a"])({url:"/api/v1/tpl",method:"put",data:e})}function c(e){return Object(o["a"])({url:"/api/v1/tpl",method:"delete",params:e})}var p={addModel:function(e){return Object(o["a"])({url:"/model/addModel",method:"post",data:e})},getAllModel:function(e){return o["a"].get("/model/getAllModel",{params:e})}},u=a("5f87"),d=a("b562"),m={name:"Template",data:function(){return{formConfig:"",formData:{},appList:[],dialogFormVisibleName:1,queryParams:{pageIndex:1,pageSize:10},loading:!1,ids:[],single:!0,multiple:!0,total:0,open:!1,tplList:[],listQuery:{applyName:""},ruleForm:{applyId:"",applyKey:"",account:Object(u["a"])(),data:""},rules:{applyId:[{required:!1,message:"请输入applyId",trigger:"blur"}]}}},created:function(){},mounted:function(){var e=this;setTimeout((function(){e.formConfig=localStorage.getItem("form-config")||""}),1e3)},methods:Object(i["a"])({handleSave:function(e){localStorage.setItem("form-config",e),this.$message.success("保存成功啦~")},querySearchAsync:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a.appList.length){e.next=4;break}return n={account:Object(u["a"])(),applyName:""},e.next=4,d["a"].getApplyInfos(n).then((function(e){200==e.code&&(e.data.forEach((function(e){e.value=e.applyName})),a.appList=e.data)}));case 4:t(a.appList);case 5:case"end":return e.stop()}}),e)})))()},getList:function(){var e=this;this.loading=!0;var t={},a=this.listQuery.applyName,n=this._.find(this.appList,(function(e){return e.applyName==a}));t.applyId=n.id,t.applyKey="",t.page=this.queryParams.pageIndex,t.amount=this.queryParams.pageSize,p.getAllModel(t).then((function(t){200==t.code?(t.data.models.forEach((function(e){e.createTime=new Date(e.createTime).toLocaleDateString().split(" ")[0]})),e.tplList=t.data.models,e.total=t.data.pageSize):e.$message({message:t.msg,type:"error"}),e.loading=!1}))},handleCreate:function(){this.ruleForm={applyId:"",applyKey:"",account:Object(u["a"])(),data:""},this.dialogFormVisibleName=1,this.open=!0},handleEdit:function(e){this.dialogFormVisibleName=2,this.open=!0},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.ruleForm.data=t.$refs.frender.formDesc,p.addModel().then((function(e){e.code})))}))},editForm:function(e){var t=this;this.handleSave(this.$refs.makingform.getJSON()),this.$refs[e].validate((function(e){e&&s(t.ruleForm).then((function(e){t.getList(),t.open=!1}))}))},handleQuery:function(e){this.queryParams.pageIndex=1,this.queryParams.pageSize=10,this.getList()},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){c({templateId:e.id}).then((function(e){void 0!==e&&(t.getList(),t.$message({type:"success",message:"模版已删除!"}))}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleSelectionChange:function(){}},"handleSave",(function(e){e.list.length>0?this.ruleForm.form_structure=e:this.ruleForm.form_structure=""}))},f=m,g=a("9ca4"),y=Object(g["a"])(f,n,r,!1,null,null,null);t["default"]=y.exports},4194:function(e,t,a){"use strict";var n=a("1c8b"),r=a("5dfd").find,i=a("258f"),l=a("ff9c"),o="find",s=!0,c=l(o);o in[]&&Array(1)[o]((function(){s=!1})),n({target:"Array",proto:!0,forced:s||!c},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i(o)},b562:function(e,t,a){"use strict";var n=a("b775");t["a"]={getApplyInfos:function(e){return Object(n["a"])({url:"/apply/getApplyInfos",method:"post",data:e})},addApplyInfo:function(e){return Object(n["a"])({url:"/apply/addApplyInfo",method:"post",data:e})},modify:function(e){return Object(n["a"])({url:"/apply/addApplyInfo",method:"post",data:e})},delete:function(e){return Object(n["a"])({url:"/apply/addApplyInfo",method:"post",data:e})},getApplyKey:function(e){return n["a"].get("/apply/getApplyKey",{params:e})}}}}]);